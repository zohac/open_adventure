# Dossier de R√©f√©rence ‚Äî Colossal Cave Adventure & Open Adventure

*(par Tristan Maher-Kent, historien du jeu vid√©o)*

---

## 1. Histoire et √âvolutions

### 1.1 Origines

- **1976** ‚Äî Will Crowther d√©veloppe la premi√®re version d‚Äô*Adventure* sur PDP-10 en FORTRAN.
  - Inspir√© par ses explorations de Mammoth Cave (Kentucky).
  - Version rudimentaire : exploration de grotte, peu d‚Äôobjets, sans scoring formalis√©.

### 1.2 Extension Don Woods (1977)

- Ajout de la dimension fantastique (dragon, tr√©sors, magie).
- Mise en place d‚Äôun syst√®me de **scoring** (objectif : 350 points).
- Diffusion large via ARPANET.

### 1.3 La version 430 points (1978 ‚Üí 1995)

- √âvolution dite **Adventure 2.x**.
- Ajout de zones, objets, puzzles suppl√©mentaires.
- **1995** : consolidation dans la version **Adventure 2.5** (430 points).

### 1.4 Ports et variantes

- Multiples forks non ‚Äúmainline‚Äù : 550, 660 points (extensions communautaires).
- Diffusions sur Unix (BSD Games), PC (1981), DOS, etc.
- Important : **ne pas confondre** ces variantes avec la ligne principale Crowther/Woods.

### 1.5 Open Adventure (2017 ‚Üí )

- Projet men√© par **Eric S. Raymond** avec l‚Äôaccord de Crowther & Woods.
- Traduction C moderne de *Adventure 2.5*.
- Donn√©es en **YAML** compil√©es en C structs.
- Licence libre BSD 2-clauses.

---

## 2. M√©caniques de Jeu

### 2.1 Exploration

- D√©placements textuels : N, S, E, O, UP, DOWN, IN, OUT.
- Commande historique **BACK/RETURN** : revient au lieu pr√©c√©dent (sauf `COND_NOBACK`), g√®re les transitions forc√©es (`oldlc2`).
- Cartographie souterraine (Hall of Mists, Maze of Twisty Passages‚Ä¶).

### 2.2 Objets et inventaire

- Objets portables : lampe, cl√©s, cage, tr√©sors‚Ä¶
- Objets fixes : fissure, porte rouill√©e‚Ä¶
- Gestion des √©tats (lampe allum√©e/√©teinte, plante arros√©e, dragon vivant/mort‚Ä¶).

### 2.3 Personnages et al√©as

- **Nains** : hostiles, apparaissent al√©atoirement, peuvent lancer une hache.
- **Pirate** : vole les tr√©sors, les d√©pose dans sa caverne.
- **Cr√©atures diverses** : serpent, dragon, ours, troll.

### 2.4 Conditions sp√©ciales

- **Lampe** : dur√©e limit√©e, recharge via batterie.
- **Eau/Huile** : n√©cessaires pour certains puzzles.
- **Phrases magiques** : d√©clenchent des t√©l√©portations ou solutions de puzzles.

---

## üìö Addendum ‚Äî Vue d‚Äôensemble historienne & pr√™te √† l‚Äôemploi (Open Adventure 430)

*(Sources primaires : `adventure.yaml`, `score.c`, `actions.c` ; documentation : `history.adoc`, `notes.adoc`.)*

### A. Comment le jeu ¬´ pense ¬ª ‚Äî Boucle de tour (vision macro)

1) **Entr√©e** : intention (verbe+objet / mouvement).  
2) **R√©solution** : d‚Äôabord **travel** (d√©placement), sinon **actions** (interaction), sinon **incompr√©hension**.  
3) **√âv√©nements** : PNJ (nains/pirate), timers (lampe), √©tats de fin (`closng/closed`).  
4) **Mise √† jour** : lieu, objets, flags, score partiel.  
5) **Sortie** : description + messages ‚Üí tour suivant.

**Invariants** : r√®gles de **travel** contextuelles ; **actions** conditionnelles (objet pr√©sent/port√©, √©tat valide) ; nains/pirate **uniquement souterrain**.

**Flags majeurs** : `dflag` (profondeur/nains), `closng/closed`, `bonus`, `numdie`, `trnluz`, `novice`.

### B. Taxonomie des commandes ‚Üí UI sans clavier (boutons)

- **Travel** : N, S, E, O, NE, NO, SE, SO, UP, DOWN, IN, OUT.  
  - Inclure **BACK/RETURN** (bouton ¬´ Revenir ¬ª) si un chemin inverse existe et que la salle n‚Äôest pas `COND_NOBACK`.  
- **Interaction** : TAKE/DROP, OPEN/CLOSE, LIGHT/EXTINGUISH, FEED, THROW, ATTACK, READ, WAVE, FILL/POUR, UNLOCK/LOCK‚Ä¶  
- **Meta** : LOOK/EXAMINE, INVENTORY, SCORE, HELP, SAVE/LOAD.

**R√®gle mobile** : afficher **3‚Äì7** choix utiles par tour. Priorit√© : **s√©curit√©** (lampe/danger) ‚Üí **navigation** (incl. `BACK/RETURN`) ‚Üí **objets** ‚Üí **m√©ta**.  
**Nota** : les **mots magiques** ne sont **pas** list√©s par d√©faut (pr√©servation de la d√©couverte ; voir ¬ß 7.1) et ne peuvent √™tre inject√©s que lorsque le joueur a appris l‚Äôincantation.

### C. PNJ historiques ‚Äî Nains & Pirate (lecture gameplay)

**Nains (pression dynamique)**  
- **O√π/quand** : **souterrain** apr√®s les premi√®res galeries.  
- **Comportement** : errance ; s‚Äôils partagent votre salle ‚Üí **jet de couteau** (souvent loup√©, parfois mortel).  
- **Contre-jeu** : **lancer la hache** ; **nourrir** un nain **aggrave** son agressivit√©.  
- **Endgame** : en **closed**, leur nuisance **s‚Äôatt√©nue**.

*UI* : journal ‚ÄúUn nain appara√Æt‚Ä¶‚Äù, bouton **Lancer la hache** visible **seulement** si nain pr√©sent + hache.

**Pirate (friction √©conomique)**  
- **O√π/quand** : jamais surface/Well House ; privil√©gie profondeur/maze.  
- **Comportement** : **vole les tr√©sors**, laisse un **billet**, **cache** tout dans sa **planque** (impasse du Maze).  
- **Cons√©quence** : **aucune perte d√©finitive** ; il **retarde** la validation des points (d√©p√¥t Well House).

*UI* : journal ‚ÄúUn pirate vous d√©trousse‚Ä¶‚Äù, puis ‚ÄúVous retrouvez la planque‚Ä¶‚Äù. Ic√¥ne ‚Äútr√©sor s√©curis√©‚Äù quand d√©pos√©.

### D. Scoring historique ‚Äî tableau d‚Äôaudit

| Cat√©gorie | Principe canonique | Points (430) | Note d‚Äôusage |
|---|---|---:|---|
| **D√©couverte tr√©sor** | Chaque tr√©sor trouv√© | +2 | Une fois par tr√©sor |
| **D√©p√¥t tr√©sor** | D√©p√¥t √† la **Well House** | +10 / +12 / +14 | Avant coffre / coffre / apr√®s coffre |
| **Progr√®s** | Entr√©e ‚Äúr√©elle‚Äù en grotte | +25 | D√©clenche ‚Äúvie souterraine‚Äù |
| **Closing** | Fin enclench√©e (`closng`) | +25 | Jalons de fin |
| **Closed ‚Üí issue** | Sortie en grotte ferm√©e | +10/25/30/45 | none / splatter / defeat / victory |
| **Survie** | (3 ‚àí morts) √ó 10 | ‚â§ +30 | Cap historique = 30 |
| **Witt‚Äôs End** | Magazine √† Witt‚Äôs End | +1 | Clin d‚Äô≈ìil |
| **Arrondi** | Ajustement final | +2 | Tradition |

**Malus** : indices (bar√®me), **novice** ‚àí5, indice de closing ‚àí10, **temps** `trnluz`, **sauvegardes** `saved`.

### E. Carte conceptuelle (zones & passages cl√©s)

Surface ‚Üî **Debris Room** (XYZZY) ‚Üî **Hall of Mists** ‚Üí **Maze** (planque pirate) / **Pont de cristal** (b√¢ton noir) / **Dragon** / **Serpent** / **Rivi√®re** ‚Üí **Sanctuaire** ‚Üí **Closing/Closed**.  
Invariants : le **maze** exige **cartographie** ; certains barrages exigent **objet** ou **mot**.

### F. Mots magiques ‚Äî politique d‚Äôexp√©rience (rappel historien)

Piliers : **XYZZY**, **PLUGH**, **PLOVER**, **FEE/FIE/FOE/FOO**. L‚ÄôUI n‚Äôen **affiche pas** les libell√©s par d√©faut ; le journal ne montre que **l‚Äôeffet**.  
üëâ La **pr√©sentation UX** des incantations rel√®ve du **Game Designer** (voir ¬ß 7.1 ‚ÄúDDR-001‚Äù).

### G. Sauvegardes ‚Äî contrat minimal

- **Autosave** apr√®s **chaque tour** + **slots** manuels.  
- Snapshot recommand√© :  
  `loc`, `visited`, `turn`, `scorePartial`, `inventory[]`, `objectsState{}`, `flags{dflag,closng,closed,bonus,novice}`, `hintsUsed[]`, `rngSeed`.  
- **Compat ascendante** (m√™me major).

### H. D√©terminisme & tests (h√©ritage ‚Äúseed‚Äù)

- **Seed** fixe ‚áí rencontres nains / vol pirate **reproductibles**.  
- **Oracles** (voir ¬ß 7.4) : 3 scripts de non-r√©gression (navette mots magiques ; nain pr√©sent/absent ; vol‚Üír√©cup‚Üíd√©p√¥t).

### I. Pi√®ges & bonnes pratiques (joueur)

- **Nains** : ne pas **nourrir** ; garder la **hache** ; lancer **uniquement** si nain pr√©sent.  
- **Pirate** : **banquer** t√¥t ; s‚Äôil vole, **planque** ‚Üí reprise ‚Üí d√©p√¥t.  
- **Lampe** : anticiper les **batteries** (430).  
- **Maze** : la carte n‚Äôexpose que le **d√©j√† visit√©** (option par d√©faut).

### J. R√©f√©rences (primaires & secondaires)

Primaires : *Open Adventure* (`adventure.yaml`, `actions.c`, `score.c`, `saveresume.c`), `history.adoc`, `notes.adoc`.  
Secondaires : Jimmy Maher (*The Digital Antiquarian*), Tristan Donovan (*Replay*), Steven L. Kent (*The Ultimate History of Video Games*), IFWiki/IFArchive.

---

## 2.5 Nains & Pirate ‚Äî m√©canique de jeu (version ¬´ ligne principale ¬ª 350/430, Open Adventure fid√®le)

> ‚ö†Ô∏è L√©ger spoiler de gameplay (comportements des PNJ, pas de solutions d‚Äô√©nigmes compl√®tes).

### 2.5.1 Les Nains (Dwarves)

**R√©sum√©** ‚Äî Ennemis souterrains ; **jets de couteaux** lors des rencontres ; **seule riposte fiable** : **lancer la hache**. Les **nourrir** les **√©nerve**. En **closed**, leur pression diminue.  
**Proc√©dure** ‚Äî (1) Premi√®re incursion : un nain rate son coup ; la **hache** appara√Æt t√¥t. (2) Rencontres ult√©rieures : attaque s‚Äôils partagent la salle. (3) Lancer la hache **uniquement** s‚Äôils sont l√† (sinon elle tombe).  
**Table** ‚Äî Zones actives : **souterrain** ; score : **aucun** pour les tuer (enjeu = **survie** et **tours**).

### 2.5.2 Le Pirate

**R√©sum√©** ‚Äî Cible **uniquement** les **tr√©sors** ; laisse un **billet** ; cache tout dans une **planque** du **Maze** ; **aucune perte d√©finitive**.  
**Proc√©dure** ‚Äî Vol ‚Üí billet ‚Üí planque ‚Üí reprise du lot ‚Üí d√©p√¥t Well House. **R√©cidive possible** tant que vous portez des tr√©sors.  
**Table** ‚Äî Lieux s√ªrs : **surface** & **Well House** ; score : retard d‚Äôencaissement, pas de malus permanent.

---

## 3. Scoring et Mots Magiques

### 3.1 Scoring (r√®gles canoniques 430 points ‚Äî Open Adventure)

> Source primaire : open-adventure / `score.c`. (Titres internes : `dflag`, `closng`, `closed`, `bonus`, etc.)

**Bar√®me positifs** ‚Äî D√©couverte de tr√©sor **+2** ; d√©p√¥t **+10/12/14** ; Progr√®s **+25** ; Closing **+25** ; Issue en closed **+10/25/30/45** ; Survie **‚â§ +30** ; Witt‚Äôs End **+1** ; Arrondi **+2**.  
**Malus** ‚Äî Indices (bar√®me), **novice ‚àí5**, indice closing **‚àí10**, **tours** `trnluz`, **sauvegardes** `saved`.  
**Impl√©mentation** ‚Äî It√®re `is_treasure`; d√©p√¥t si `place==LOC_BUILDING` & `found`; ordre : positifs ‚Üí d√©ductions ; **classe finale** via `classes[]`.

### 3.2 Scoring (version 350 points ‚Äî rep√®res)

Logique similaire mais **pond√©rations** et **plafond** diff√©rents (350), bonus d‚Äô‚Äúendgame‚Äù moins d√©velopp√©s (sp√©cifiques 430).

### 3.3 Mots magiques (liste)

> ‚ö†Ô∏è Spoiler l√©ger.

| Mot | Effet | Conditions | 350/430 | Origine | Note |
|---|---|---|:--:|---|---|
| **XYZZY** | Building ‚Üî Debris | Uniquement dans ces pi√®ces | ‚úîÔ∏é | Crowther | Conserv√© |
| **PLUGH** | Building ‚Üî Y2 | ‚ÄúHollow voice‚Äù √† Y2 | ‚úîÔ∏é | Woods | Conserv√© |
| **PLOVER** | Plover ‚Üî Y2 | Bypass Dark Room | ‚úîÔ∏é | Woods | Conserv√© |
| **FEE/FIE/FOE/FOO** | Rappelle les ≈ìufs | S√©quence en Giant‚Äôs Room | ‚úîÔ∏é | Woods | Conserv√© |

---

## 4. Open Adventure ‚Äî Diff√©rences Modernes

- **Fid√©lit√© stricte** au gameplay 2.5 (430).  
- Changements **r√©versibles** via `-o` (oldstyle).  
- Donn√©es `adventure.yaml` ‚Üí C idiomatique ; options : `seed`, `version`, prompt `>`, alias (`l`,`x`,`z`,`i`,`g`).  
- **Sauvegardes robustes**, **seed** pour rejouabilit√©/QA.

---

## 5. Annexes (sources)

Primaires : `open-adventure-master/` (`score.c`, `actions.c`, `saveresume.c`, `adventure.yaml`), `history.adoc`, `notes.adoc`.  
Secondaires : Maher, Donovan, Kent ; IFWiki, IFArchive.

---

## 6. Puzzles difficiles ou controvers√©s (rep√®res)

Gouffre & b√¢ton noir (pont de cristal), Dragon (attaque verbale), ≈íufs d‚Äôor & pirate (planque), Troll (p√©age), Vase Ming (coussin), Serpent (oiseau), Labyrinthes (cartographie), Witt‚Äôs End (cul-de-sac), G√©ant (s√©quence), Coffre (portage).

---

## 7. Adaptation Mobile ‚Äî D√©cisions √† figer (CTO & Game Designer)

> Objectif : supprimer les ambigu√Øt√©s d‚Äôex√©cution tout en respectant l‚ÄôADN historique.

### 7.1 DDR-001 ‚Äî **Incantations (mots magiques) : politique UX**

- **Option A ‚Äî Fid√©lit√© pure (recommandation historienne par d√©faut du dossier)**  
  Les mots restent **secrets** tant que le joueur ne les a pas d√©couverts in-universe (oiseaux, billets, st√®les, indices). Une fois r√©v√©l√©s, l‚ÄôUI ajoute uniquement dans les **lieux concern√©s** un bouton contextuel ¬´ Utiliser l‚Äôincantation ¬ª libell√© avec le mot appris ‚Äî jamais de liste globale. Aucun co√ªt additionnel n‚Äôest impos√© : seule l‚Äôutilisation d‚Äôun **indice** conserve la p√©nalit√© historique d√©j√† codifi√©e.
- **Option B ‚Äî Mixte (exception ‚Äúclavier cibl√©‚Äù)**  
  UI boutons + champ ‚Äúincantation‚Äù **contextuel** (apparition seulement dans les pi√®ces concern√©es). Les mots ne sont pas list√©s.
- **Option C ‚Äî Gamey (z√©ro clavier, UX guid√©e)**  
  Cartouches d‚Äôincantation **d√©verrouill√©es** par d√©couverte/indice ; bouton ‚ÄúUtiliser l‚Äôincantation‚Äù propos√© **apr√®s** d√©blocage.

> **√Ä trancher par le Game Designer.** Le pr√©sent dossier retient **Option A** tant qu‚Äôun DDR sign√© ne dit pas le contraire.  
> Si **Option B** est choisie, elle introduit une **unique exception** √† la r√®gle ‚Äúz√©ro clavier‚Äù.

### 7.2 Appendice d‚Äô√©quilibrage historique (exposition UX/QA)

- **Lampe** : dur√©e en tours, seuil d‚Äôalerte texte, cadence de messages de batterie faible.  
- **Nains** : cadence moyenne de rencontre, fr√©quence de jet rat√©/r√©ussi, att√©nuation en `closed`.  
- **Pirate** : d√©clencheur d‚Äôapparition (port de tr√©sors, zones), planque unique dans le Maze, immunit√© surface/Well House.

> *But* : rendre v√©rifiable l‚Äô√©quilibre **sans** ouvrir le code C. (Valeurs d√©taill√©es √† reprendre telles quelles de `adventure.yaml`/`actions.c` dans un tableau interne de production.)

### 7.3 Sauvegarde ‚Äî **exemple JSON minimal** (sch√©ma V1)

```json
{
  "schema_version": 1,
  "rng_seed": 123456789,
  "turn": 42,
  "score_partial": 87,
  "location": "HALL_OF_MISTS",
  "visited": ["BUILDING","DEBRIS","HALL_OF_MISTS"],
  "inventory": ["LAMP","AXE","CAGE"],
  "objects_state": { "BIRD": "caged", "DRAGON": "alive", "VASE": "intact" },
  "flags": { "dflag": 2, "closng": false, "closed": false, "bonus": "none", "novice": false },
  "hints_used": [3],
  "obituaries": 0
}
```

### 7.4 Oracles seed√©s ‚Äî tests de fid√©lit√©

- O1 ‚Äî Navette mots magiques : Building ‚Üî Debris (XYZZY), Building ‚Üî Y2 (PLUGH) ‚Üí v√©rif locales/texte.
- O2 ‚Äî Nain : √©tat avec/ sans nain pr√©sent ‚Üí ‚ÄúLancer la hache‚Äù visible/absent ; issue du lancer ; journal attendu.
- O3 ‚Äî Pirate : port de tr√©sors ‚Üí vol (billet) ‚Üí planque (r√©cup) ‚Üí d√©p√¥t ‚Üí score.

> Comparaison : messages (tol√©rance espaces) + √©tats (loc, inventaire, score, flags).

### 7.5 Accessibilit√© ‚Äî Definition of Done (AA)

- Polices : 3 crans min ; contrastes AA (clair/sombre).
- Focus : ordre d√©terministe (image ‚Üí titre ‚Üí description ‚Üí actions ‚Üí barre).
- Semantics : labels complets sur tous boutons ; journal annonc√© par lot.
- Option texte-seul : d√©sactivation images (faible RAM).

### 7.6 Cibles mat√©rielles & perfs

- Golden devices QA : Android A53 (2019), iPhone XR/11.
- Budgets : cold start <1,0 s, interaction 60 fps, m√©moire <150 Mo.
- Cache images/audio : LRU simple, plafond RAM configurable (par d√©faut ~32‚Äì48 Mo art, ~4‚Äì8 Mo audio d√©cod√©).

### 7.7 Plan des Indices (UX)

- Opt-in via bouton Indices ; jamais intrusif.
- P√©nalit√©s conformes au bar√®me historique.
- Texte d‚Äôindice contextuel (lieu/√©tat), non spoilant au premier niveau (niveaux 1‚Üí2‚Üísolution).

### 7.8 DDR ‚Äî Registre de d√©cisions

- DDR-001 Incantations (A/B/C) ‚Äî par d√©faut : A (fid√©lit√© pure).
- DDR-002 Carte/minimap ‚Äî n‚Äôaffiche que les salles visit√©es (ic√¥nes cl√©s facultatives).
- DDR-003 Messages de s√©curit√© ‚Äî autoriser un pr√©-avertissement lampe faible (non pr√©sent en 1977) : NON par d√©faut ; OUI seulement avec drapeau ‚Äúaccessibilit√©‚Äù.

## 8. Open Adventure ‚Äî Diff√©rences Modernes (rappel)

- Fid√©lit√© stricte 2.5/430 ; changements techniques r√©versibles (`-o`).
- Donn√©es YAML ‚Üí C ; options `seed`, `version`, prompt `>`, alias (`l`,`x`,`z`,`i`,`g`).
- Sauvegardes robustes ; rejouabilit√© par seed.

## 9. Annexes (sources & lectures)

`Primaires` : `open-adventure-master`/ (`score.c`, `actions.c`, `saveresume.c`, `adventure.yaml`), `history.adoc`, `notes.adoc`.
Secondaires : Maher (Digital Antiquarian), Donovan (Replay), Kent (Ultimate History), IFWiki/IFArchive.

## 10. Puzzles difficiles ‚Äî m√©mo d‚Äô√©quipe

Gouffre/b√¢ton noir (pont), Dragon (attaque verbale), ≈íufs/pirate (planque), Troll (p√©age), Vase Ming (coussin), Serpent (oiseau), Labyrinthes (carto), Witt‚Äôs End (cul-de-sac), G√©ant (s√©quence), Coffre (portage).

## üîé Conclusion

Le pr√©sent dossier suffit pour guider CTO & Game Designer vers une adaptation mobile offline fid√®le √† Open Adventure.

Les points sensibles UX (incantations, carte, messages de s√©curit√©) sont explicitement remis √† l‚Äôarbitrage GD via DDR, sans alt√©rer la fid√©lit√© historique par d√©faut.

Les oracles seed√©s, l‚Äôexemple de sauvegarde et l‚Äôappendice d‚Äô√©quilibrage donnent aux devs & QA des rep√®res actionnables et testables.

```makefile
::contentReference[oaicite:0]{index=0}
```
